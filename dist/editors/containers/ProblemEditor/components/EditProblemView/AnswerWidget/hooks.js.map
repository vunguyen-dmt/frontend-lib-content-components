{"version":3,"file":"hooks.js","names":["_react","require","_utils","_module","_interopRequireWildcard","_redux","_problem","_hooks2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","key","value","_toPropertyKey","configurable","writable","_toPrimitive","String","Symbol","toPrimitive","TypeError","Number","state","exports","StrictDict","isFeedbackVisible","val","useState","removeAnswer","_ref","answer","dispatch","actions","problem","deleteAnswer","id","correct","editorState","fetchEditorContent","format","setAnswer","_ref2","hasSingleAnswer","payload","updateAnswer","setAnswerTitle","_ref3","problemType","updatedTitle","title","ProblemTypeKeys","TEXTINPUT","NUMERIC","DROPDOWN","includes","target","setSelectedFeedback","_ref4","selectedFeedback","setUnselectedFeedback","_ref5","unselectedFeedback","useFeedback","setIsFeedbackVisible","module","useEffect","isVisible","toggleFeedback","open","isSingleAnswerProblem","useAnswerContainer","_ref6","answers","updateField","answerCount","correctAnswerCount","_default"],"sources":["../../../../../../../src/editors/containers/ProblemEditor/components/EditProblemView/AnswerWidget/hooks.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { StrictDict } from '../../../../../utils';\nimport * as module from './hooks';\nimport { actions } from '../../../../../data/redux';\nimport { ProblemTypeKeys } from '../../../../../data/constants/problem';\nimport { fetchEditorContent } from '../hooks';\n\nexport const state = StrictDict({\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  isFeedbackVisible: (val) => useState(val),\n});\n\nexport const removeAnswer = ({\n  answer,\n  dispatch,\n}) => () => {\n  dispatch(actions.problem.deleteAnswer({\n    id: answer.id,\n    correct: answer.correct,\n    editorState: fetchEditorContent({ format: '' }),\n  }));\n};\n\nexport const setAnswer = ({ answer, hasSingleAnswer, dispatch }) => (payload) => {\n  dispatch(actions.problem.updateAnswer({ id: answer.id, hasSingleAnswer, ...payload }));\n};\n\nexport const setAnswerTitle = ({\n  answer,\n  hasSingleAnswer,\n  dispatch,\n  problemType,\n}) => (updatedTitle) => {\n  let title = updatedTitle;\n  if ([ProblemTypeKeys.TEXTINPUT, ProblemTypeKeys.NUMERIC, ProblemTypeKeys.DROPDOWN].includes(problemType)) {\n    title = updatedTitle.target.value;\n  }\n  dispatch(actions.problem.updateAnswer({ id: answer.id, hasSingleAnswer, title }));\n};\n\nexport const setSelectedFeedback = ({ answer, hasSingleAnswer, dispatch }) => (e) => {\n  dispatch(actions.problem.updateAnswer({\n    id: answer.id,\n    hasSingleAnswer,\n    selectedFeedback: e.target.value,\n  }));\n};\n\nexport const setUnselectedFeedback = ({ answer, hasSingleAnswer, dispatch }) => (e) => {\n  dispatch(actions.problem.updateAnswer({\n    id: answer.id,\n    hasSingleAnswer,\n    unselectedFeedback: e.target.value,\n  }));\n};\n\nexport const useFeedback = (answer) => {\n  const [isFeedbackVisible, setIsFeedbackVisible] = module.state.isFeedbackVisible(false);\n  useEffect(() => {\n    // Show feedback fields if feedback is present\n    const isVisible = !!answer.selectedFeedback || !!answer.unselectedFeedback;\n    setIsFeedbackVisible(isVisible);\n  }, [answer]);\n\n  const toggleFeedback = (open) => {\n    // Do not allow to hide if feedback is added\n    const { selectedFeedback, unselectedFeedback } = fetchEditorContent({ format: '' });\n\n    if (!!selectedFeedback?.[answer.id] || !!unselectedFeedback?.[answer.id]) {\n      setIsFeedbackVisible(true);\n      return;\n    }\n    setIsFeedbackVisible(open);\n  };\n  return {\n    isFeedbackVisible,\n    toggleFeedback,\n  };\n};\n\nexport const isSingleAnswerProblem = (problemType) => (\n  problemType === ProblemTypeKeys.DROPDOWN\n);\n\nexport const useAnswerContainer = ({ answers, updateField }) => {\n  useEffect(() => {\n    let answerCount = 0;\n    answers.forEach(answer => {\n      if (answer.correct) {\n        answerCount += 1;\n      }\n    });\n    updateField({ correctAnswerCount: answerCount });\n  }, []);\n};\n\nexport default {\n  state, removeAnswer, setAnswer, setAnswerTitle, useFeedback, isSingleAnswerProblem, useAnswerContainer,\n};\n"],"mappings":"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"}