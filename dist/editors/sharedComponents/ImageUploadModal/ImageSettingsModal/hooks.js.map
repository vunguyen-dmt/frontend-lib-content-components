{"version":3,"file":"hooks.js","names":["_react","_interopRequireDefault","require","_utils","_module","_interopRequireWildcard","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","value","_toPropertyKey","configurable","writable","_toPrimitive","String","Symbol","toPrimitive","TypeError","Number","state","exports","altText","val","React","useState","dimensions","showAltTextDismissibleError","showAltTextSubmissionError","isDecorative","isLocked","local","lockAspectRatio","dimKeys","StrictDict","height","width","findGcd","b","gcd","some","v","isInteger","checkEqual","d1","d2","getValidDimensions","_ref","out","changed","other","Math","round","reduceDimensions","module","dimensionLockHooks","setLockAspectRatio","setIsLocked","initializeLock","_ref2","w","h","lock","unlock","dimensionHooks","altTextHook","setDimensions","setLocal","setAll","_ref3","setIsDecorative","setValue","setHeight","match","heightPercent","parseInt","setWidth","widthPercent","onImgLoad","selection","_ref4","target","img","imageDims","naturalHeight","naturalWidth","updateDimensions","altTextHooks","savedText","setShowAltTextDismissibleError","setShowAltTextSubmissionError","validateAltText","newVal","newDecorative","decorative","error","show","dismiss","validation","onInputChange","handleValue","onCheckboxChange","checked","checkFormValidation","_ref5","onAltTextFail","onSaveClick","_ref6","saveToEditor","_default"],"sources":["../../../../../src/editors/sharedComponents/ImageUploadModal/ImageSettingsModal/hooks.js"],"sourcesContent":["import React from 'react';\n\nimport { StrictDict } from '../../../utils';\nimport * as module from './hooks';\n\n// Simple wrappers for useState to allow easy mocking for tests.\nexport const state = {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  altText: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  dimensions: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  showAltTextDismissibleError: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  showAltTextSubmissionError: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  isDecorative: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  isLocked: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  local: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  lockAspectRatio: (val) => React.useState(val),\n};\n\nexport const dimKeys = StrictDict({\n  height: 'height',\n  width: 'width',\n});\n\n/**\n * findGcd(numerator, denominator)\n * Find the greatest common denominator of a ratio or fraction, which may be 1.\n * @param {number} numerator - ratio numerator\n * @param {number} denominator - ratio denominator\n * @return {number} - ratio greatest common denominator\n */\nexport const findGcd = (a, b) => {\n  const gcd = b ? findGcd(b, a % b) : a;\n\n  if (gcd === 1 || [a, b].some(v => !Number.isInteger(v / gcd))) {\n    return 1;\n  }\n\n  return gcd;\n};\n\nconst checkEqual = (d1, d2) => (d1.height === d2.height && d1.width === d2.width);\n\n/**\n * getValidDimensions({ dimensions, local, locked })\n * Find valid ending dimensions based on start state, request, and lock state\n * @param {obj} dimensions - current stored dimensions\n * @param {obj} local - local (active) dimensions in the inputs\n * @param {obj} locked - locked dimensions\n * @return {obj} - output dimensions after move ({ height, width })\n */\nexport const getValidDimensions = ({\n  dimensions,\n  local,\n  isLocked,\n  lockAspectRatio,\n}) => {\n  // if lock is not active, just return new dimensions.\n  // If lock is active, but dimensions have not changed, also just return new dimensions.\n  if (!isLocked || checkEqual(local, dimensions)) {\n    return local;\n  }\n\n  const out = {};\n\n  // changed key is value of local height if that has changed, otherwise width.\n  const keys = (local.height !== dimensions.height)\n    ? { changed: dimKeys.height, other: dimKeys.width }\n    : { changed: dimKeys.width, other: dimKeys.height };\n\n  out[keys.changed] = local[keys.changed];\n  out[keys.other] = Math.round((local[keys.changed] * lockAspectRatio[keys.other]) / lockAspectRatio[keys.changed]);\n\n  return out;\n};\n\n/**\n * reduceDimensions(width, height)\n * reduces both values by dividing by their greates common denominator (which can simply be 1).\n * @return {Array} [width, height]\n */\nexport const reduceDimensions = (width, height) => {\n  const gcd = module.findGcd(width, height);\n\n  return [width / gcd, height / gcd];\n};\n\n/**\n * dimensionLockHooks({ dimensions })\n * Returns a set of hooks pertaining to the dimension locks.\n * Locks the dimensions initially, on lock initialization.\n * @param {obj} dimensions - current stored dimensions\n * @return {obj} - dimension lock hooks\n *   {func} initializeLock - enable the lock mechanism\n *   {bool} isLocked - are dimensions locked?\n *   {obj} lockAspectRatio - image dimensions ({ height, width })\n *   {func} lock - lock the dimensions\n *   {func} unlock - unlock the dimensions\n */\nexport const dimensionLockHooks = () => {\n  const [lockAspectRatio, setLockAspectRatio] = module.state.lockAspectRatio(null);\n  const [isLocked, setIsLocked] = module.state.isLocked(true);\n\n  const initializeLock = ({ width, height }) => {\n    // width and height are treated as a fraction and reduced.\n    const [w, h] = reduceDimensions(width, height);\n\n    setLockAspectRatio({ width: w, height: h });\n  };\n\n  return {\n    initializeLock,\n    isLocked,\n    lock: () => setIsLocked(true),\n    lockAspectRatio,\n    unlock: () => setIsLocked(false),\n  };\n};\n\n/**\n * dimensionHooks()\n * Returns an object of dimension-focused react hooks.\n * @return {obj} - dimension hooks\n *   {func} onImgLoad - initializes image dimension fields\n *     @param {object} selection - selected image object with possible override dimensions.\n *     @return {callback} - image load event callback that loads dimensions.\n *   {object} locked - current locked state\n *   {func} lock - lock current dimensions\n *   {func} unlock - unlock dimensions\n *   {object} value - current dimension values\n *   {func} setHeight - set height\n *     @param {string} - new height string\n *   {func} setWidth - set width\n *     @param {string} - new width string\n *   {func} updateDimensions - set dimensions based on state\n *   {obj} errorProps - props for user feedback error\n *     {bool} isError - true if dimensions are blank\n *     {func} setError - sets isError to true\n *     {func} dismissError - sets isError to false\n *     {bool} isHeightValid - true if height field is ready to save\n *     {func} setHeightValid - sets isHeightValid to true\n *     {func} setHeightNotValid - sets isHeightValid to false\n *     {bool} isWidthValid - true if width field is ready to save\n *     {func} setWidthValid - sets isWidthValid to true\n *     {func} setWidthNotValid - sets isWidthValid to false\n */\nexport const dimensionHooks = (altTextHook) => {\n  const [dimensions, setDimensions] = module.state.dimensions(null);\n  const [local, setLocal] = module.state.local(null);\n\n  const setAll = ({ height, width, altText }) => {\n    if (altText === '' || altText) {\n      if (altText === '') {\n        altTextHook.setIsDecorative(true);\n      }\n      altTextHook.setValue(altText);\n    }\n    setDimensions({ height, width });\n    setLocal({ height, width });\n  };\n\n  const setHeight = (height) => {\n    if (height.match(/[0-9]+[%]{1}/)) {\n      const heightPercent = height.match(/[0-9]+[%]{1}/)[0];\n      setLocal({ ...local, height: heightPercent });\n    } else if (height.match(/[0-9]/)) {\n      setLocal({ ...local, height: parseInt(height, 10) });\n    }\n  };\n\n  const setWidth = (width) => {\n    if (width.match(/[0-9]+[%]{1}/)) {\n      const widthPercent = width.match(/[0-9]+[%]{1}/)[0];\n      setLocal({ ...local, width: widthPercent });\n    } else if (width.match(/[0-9]/)) {\n      setLocal({ ...local, width: parseInt(width, 10) });\n    }\n  };\n\n  const {\n    initializeLock,\n    isLocked,\n    lock,\n    lockAspectRatio,\n    unlock,\n  } = module.dimensionLockHooks({ dimensions });\n\n  return {\n    onImgLoad: (selection) => ({ target: img }) => {\n      const imageDims = { height: img.naturalHeight, width: img.naturalWidth };\n      setAll(selection.height ? selection : imageDims);\n      initializeLock(selection.height ? selection : imageDims);\n    },\n    isLocked,\n    lock,\n    unlock,\n    value: local,\n    setHeight,\n    setWidth,\n    updateDimensions: () => setAll(module.getValidDimensions({\n      dimensions,\n      local,\n      isLocked,\n      lockAspectRatio,\n    })),\n  };\n};\n\n/**\n * altTextHooks(savedText)\n * Returns a set of react hooks focused around alt text\n * @return {obj} - alt text hooks\n *   {string} value - alt text value\n *   {func} setValue - set alt test value\n *     @param {string} - new alt text\n *   {bool} isDecorative - is the image decorative?\n *   {func} setIsDecorative - set isDecorative field\n *   {obj} error - error at top of page\n *     {bool} show - is error being displayed?\n *     {func} set - set show to true\n *     {func} dismiss - set show to false\n *   {obj} validation - local alt text error\n *     {bool} show - is validation error being displayed?\n *     {func} set - set validation to true\n *     {func} dismiss - set validation to false\n */\nexport const altTextHooks = (savedText) => {\n  const [value, setValue] = module.state.altText(savedText || '');\n  const [isDecorative, setIsDecorative] = module.state.isDecorative(false);\n  const [showAltTextDismissibleError, setShowAltTextDismissibleError] = module.state.showAltTextDismissibleError(false);\n  const [showAltTextSubmissionError, setShowAltTextSubmissionError] = module.state.showAltTextSubmissionError(false);\n\n  const validateAltText = (newVal, newDecorative) => {\n    if (showAltTextSubmissionError) {\n      if (newVal || newDecorative) {\n        setShowAltTextSubmissionError(false);\n      }\n    }\n  };\n\n  return {\n    value,\n    setValue: (val) => {\n      setValue(val);\n      validateAltText(val, null);\n    },\n    isDecorative,\n    setIsDecorative: (decorative) => {\n      setIsDecorative(decorative);\n      validateAltText(null, decorative);\n    },\n    error: {\n      show: showAltTextDismissibleError,\n      set: () => setShowAltTextDismissibleError(true),\n      dismiss: () => setShowAltTextDismissibleError(false),\n    },\n    validation: {\n      show: showAltTextSubmissionError,\n      set: () => setShowAltTextSubmissionError(true),\n      dismiss: () => setShowAltTextSubmissionError(false),\n    },\n  };\n};\n\n/**\n * onInputChange(handleValue)\n * Simple event handler forwarding the event target value to a given callback\n * @param {func} handleValue - event value handler\n * @return {func} - evt callback that will call handleValue with the event target value.\n */\nexport const onInputChange = (handleValue) => (e) => handleValue(e.target.value);\n\n/**\n * onCheckboxChange(handleValue)\n * Simple event handler forwarding the event target checked prop to a given callback\n * @param {func} handleValue - event value handler\n * @return {func} - evt callback that will call handleValue with the event target checked prop.\n */\nexport const onCheckboxChange = (handleValue) => (e) => handleValue(e.target.checked);\n\n/**\n * checkFormValidation({ altText, isDecorative, onAltTextFail })\n * Handle saving the image context to the text editor\n * @param {string} altText - image alt text\n * @param {bool} isDecorative - is the image decorative?\n * @param {func} onAltTextFail - called if alt text validation fails\n */\nexport const checkFormValidation = ({\n  altText,\n  isDecorative,\n  onAltTextFail,\n}) => {\n  if (!isDecorative && altText === '') {\n    onAltTextFail();\n    return false;\n  }\n  return true;\n};\n\n/**\n * onSave({ altText, dimensions, isDecorative, saveToEditor })\n * Handle saving the image context to the text editor\n * @param {string} altText - image alt text\n * @param {object} dimensions - image dimensions ({ width, height })\n * @param {bool} isDecorative - is the image decorative?\n * @param {func} saveToEditor - save method for submitting image settings.\n */\nexport const onSaveClick = ({\n  altText,\n  dimensions,\n  isDecorative,\n  saveToEditor,\n}) => () => {\n  if (module.checkFormValidation({\n    altText: altText.value,\n    isDecorative,\n    onAltTextFail: () => {\n      altText.error.set();\n      altText.validation.set();\n    },\n  })) {\n    altText.error.dismiss();\n    altText.validation.dismiss();\n    saveToEditor({\n      altText: altText.value,\n      dimensions,\n      isDecorative,\n    });\n  }\n};\n\nexport default {\n  altText: altTextHooks,\n  dimensions: dimensionHooks,\n  onCheckboxChange,\n  onInputChange,\n  onSaveClick,\n  checkFormValidation,\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAC,uBAAA,CAAAH,OAAA;AAAkC,SAAAI,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAF,wBAAAE,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,IAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAc,CAAA,SAAAI,CAAA,GAAAR,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAI,CAAA,KAAAA,CAAA,CAAAX,GAAA,IAAAW,CAAA,CAAAC,GAAA,IAAAR,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAI,CAAA,IAAAV,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAgB,GAAA,CAAAnB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA,SAAAd,uBAAA0B,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAhB,UAAA,GAAAgB,GAAA,KAAAf,OAAA,EAAAe,GAAA;AAAA,SAAAC,QAAArB,CAAA,EAAAE,CAAA,QAAAC,CAAA,GAAAQ,MAAA,CAAAW,IAAA,CAAAtB,CAAA,OAAAW,MAAA,CAAAY,qBAAA,QAAAC,CAAA,GAAAb,MAAA,CAAAY,qBAAA,CAAAvB,CAAA,GAAAE,CAAA,KAAAsB,CAAA,GAAAA,CAAA,CAAAC,MAAA,WAAAvB,CAAA,WAAAS,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAE,CAAA,EAAAwB,UAAA,OAAAvB,CAAA,CAAAwB,IAAA,CAAAC,KAAA,CAAAzB,CAAA,EAAAqB,CAAA,YAAArB,CAAA;AAAA,SAAA0B,cAAA7B,CAAA,aAAAE,CAAA,MAAAA,CAAA,GAAA4B,SAAA,CAAAC,MAAA,EAAA7B,CAAA,UAAAC,CAAA,WAAA2B,SAAA,CAAA5B,CAAA,IAAA4B,SAAA,CAAA5B,CAAA,QAAAA,CAAA,OAAAmB,OAAA,CAAAV,MAAA,CAAAR,CAAA,OAAA6B,OAAA,WAAA9B,CAAA,IAAA+B,eAAA,CAAAjC,CAAA,EAAAE,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAS,MAAA,CAAAuB,yBAAA,GAAAvB,MAAA,CAAAwB,gBAAA,CAAAnC,CAAA,EAAAW,MAAA,CAAAuB,yBAAA,CAAA/B,CAAA,KAAAkB,OAAA,CAAAV,MAAA,CAAAR,CAAA,GAAA6B,OAAA,WAAA9B,CAAA,IAAAS,MAAA,CAAAC,cAAA,CAAAZ,CAAA,EAAAE,CAAA,EAAAS,MAAA,CAAAE,wBAAA,CAAAV,CAAA,EAAAD,CAAA,iBAAAF,CAAA;AAAA,SAAAiC,gBAAAb,GAAA,EAAAgB,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAhB,GAAA,IAAAT,MAAA,CAAAC,cAAA,CAAAQ,GAAA,EAAAgB,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAX,UAAA,QAAAa,YAAA,QAAAC,QAAA,oBAAApB,GAAA,CAAAgB,GAAA,IAAAC,KAAA,WAAAjB,GAAA;AAAA,SAAAkB,eAAAnC,CAAA,QAAAe,CAAA,GAAAuB,YAAA,CAAAtC,CAAA,uCAAAe,CAAA,GAAAA,CAAA,GAAAwB,MAAA,CAAAxB,CAAA;AAAA,SAAAuB,aAAAtC,CAAA,EAAAD,CAAA,2BAAAC,CAAA,KAAAA,CAAA,SAAAA,CAAA,MAAAH,CAAA,GAAAG,CAAA,CAAAwC,MAAA,CAAAC,WAAA,kBAAA5C,CAAA,QAAAkB,CAAA,GAAAlB,CAAA,CAAAiB,IAAA,CAAAd,CAAA,EAAAD,CAAA,uCAAAgB,CAAA,SAAAA,CAAA,YAAA2B,SAAA,yEAAA3C,CAAA,GAAAwC,MAAA,GAAAI,MAAA,EAAA3C,CAAA;AAElC;AACO,MAAM4C,KAAK,GAAAC,OAAA,CAAAD,KAAA,GAAG;EACnB;EACAE,OAAO,EAAGC,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACrC;EACAG,UAAU,EAAGH,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACxC;EACAI,2BAA2B,EAAGJ,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACzD;EACAK,0BAA0B,EAAGL,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACxD;EACAM,YAAY,EAAGN,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EAC1C;EACAO,QAAQ,EAAGP,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACtC;EACAQ,KAAK,EAAGR,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACnC;EACAS,eAAe,EAAGT,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG;AAC9C,CAAC;AAEM,MAAMU,OAAO,GAAAZ,OAAA,CAAAY,OAAA,GAAG,IAAAC,iBAAU,EAAC;EAChCC,MAAM,EAAE,QAAQ;EAChBC,KAAK,EAAE;AACT,CAAC,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,OAAO,GAAGA,CAACtD,CAAC,EAAEuD,CAAC,KAAK;EAC/B,MAAMC,GAAG,GAAGD,CAAC,GAAGD,OAAO,CAACC,CAAC,EAAEvD,CAAC,GAAGuD,CAAC,CAAC,GAAGvD,CAAC;EAErC,IAAIwD,GAAG,KAAK,CAAC,IAAI,CAACxD,CAAC,EAAEuD,CAAC,CAAC,CAACE,IAAI,CAACC,CAAC,IAAI,CAACtB,MAAM,CAACuB,SAAS,CAACD,CAAC,GAAGF,GAAG,CAAC,CAAC,EAAE;IAC7D,OAAO,CAAC;EACV;EAEA,OAAOA,GAAG;AACZ,CAAC;AAAClB,OAAA,CAAAgB,OAAA,GAAAA,OAAA;AAEF,MAAMM,UAAU,GAAGA,CAACC,EAAE,EAAEC,EAAE,KAAMD,EAAE,CAACT,MAAM,KAAKU,EAAE,CAACV,MAAM,IAAIS,EAAE,CAACR,KAAK,KAAKS,EAAE,CAACT,KAAM;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMU,kBAAkB,GAAGC,IAAA,IAK5B;EAAA,IAL6B;IACjCrB,UAAU;IACVK,KAAK;IACLD,QAAQ;IACRE;EACF,CAAC,GAAAe,IAAA;EACC;EACA;EACA,IAAI,CAACjB,QAAQ,IAAIa,UAAU,CAACZ,KAAK,EAAEL,UAAU,CAAC,EAAE;IAC9C,OAAOK,KAAK;EACd;EAEA,MAAMiB,GAAG,GAAG,CAAC,CAAC;;EAEd;EACA,MAAMrD,IAAI,GAAIoC,KAAK,CAACI,MAAM,KAAKT,UAAU,CAACS,MAAM,GAC5C;IAAEc,OAAO,EAAEhB,OAAO,CAACE,MAAM;IAAEe,KAAK,EAAEjB,OAAO,CAACG;EAAM,CAAC,GACjD;IAAEa,OAAO,EAAEhB,OAAO,CAACG,KAAK;IAAEc,KAAK,EAAEjB,OAAO,CAACE;EAAO,CAAC;EAErDa,GAAG,CAACrD,IAAI,CAACsD,OAAO,CAAC,GAAGlB,KAAK,CAACpC,IAAI,CAACsD,OAAO,CAAC;EACvCD,GAAG,CAACrD,IAAI,CAACuD,KAAK,CAAC,GAAGC,IAAI,CAACC,KAAK,CAAErB,KAAK,CAACpC,IAAI,CAACsD,OAAO,CAAC,GAAGjB,eAAe,CAACrC,IAAI,CAACuD,KAAK,CAAC,GAAIlB,eAAe,CAACrC,IAAI,CAACsD,OAAO,CAAC,CAAC;EAEjH,OAAOD,GAAG;AACZ,CAAC;;AAED;AACA;AACA;AACA;AACA;AAJA3B,OAAA,CAAAyB,kBAAA,GAAAA,kBAAA;AAKO,MAAMO,gBAAgB,GAAGA,CAACjB,KAAK,EAAED,MAAM,KAAK;EACjD,MAAMI,GAAG,GAAGe,OAAM,CAACjB,OAAO,CAACD,KAAK,EAAED,MAAM,CAAC;EAEzC,OAAO,CAACC,KAAK,GAAGG,GAAG,EAAEJ,MAAM,GAAGI,GAAG,CAAC;AACpC,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXAlB,OAAA,CAAAgC,gBAAA,GAAAA,gBAAA;AAYO,MAAME,kBAAkB,GAAGA,CAAA,KAAM;EACtC,MAAM,CAACvB,eAAe,EAAEwB,kBAAkB,CAAC,GAAGF,OAAM,CAAClC,KAAK,CAACY,eAAe,CAAC,IAAI,CAAC;EAChF,MAAM,CAACF,QAAQ,EAAE2B,WAAW,CAAC,GAAGH,OAAM,CAAClC,KAAK,CAACU,QAAQ,CAAC,IAAI,CAAC;EAE3D,MAAM4B,cAAc,GAAGC,KAAA,IAAuB;IAAA,IAAtB;MAAEvB,KAAK;MAAED;IAAO,CAAC,GAAAwB,KAAA;IACvC;IACA,MAAM,CAACC,CAAC,EAAEC,CAAC,CAAC,GAAGR,gBAAgB,CAACjB,KAAK,EAAED,MAAM,CAAC;IAE9CqB,kBAAkB,CAAC;MAAEpB,KAAK,EAAEwB,CAAC;MAAEzB,MAAM,EAAE0B;IAAE,CAAC,CAAC;EAC7C,CAAC;EAED,OAAO;IACLH,cAAc;IACd5B,QAAQ;IACRgC,IAAI,EAAEA,CAAA,KAAML,WAAW,CAAC,IAAI,CAAC;IAC7BzB,eAAe;IACf+B,MAAM,EAAEA,CAAA,KAAMN,WAAW,CAAC,KAAK;EACjC,CAAC;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BApC,OAAA,CAAAkC,kBAAA,GAAAA,kBAAA;AA2BO,MAAMS,cAAc,GAAIC,WAAW,IAAK;EAC7C,MAAM,CAACvC,UAAU,EAAEwC,aAAa,CAAC,GAAGZ,OAAM,CAAClC,KAAK,CAACM,UAAU,CAAC,IAAI,CAAC;EACjE,MAAM,CAACK,KAAK,EAAEoC,QAAQ,CAAC,GAAGb,OAAM,CAAClC,KAAK,CAACW,KAAK,CAAC,IAAI,CAAC;EAElD,MAAMqC,MAAM,GAAGC,KAAA,IAAgC;IAAA,IAA/B;MAAElC,MAAM;MAAEC,KAAK;MAAEd;IAAQ,CAAC,GAAA+C,KAAA;IACxC,IAAI/C,OAAO,KAAK,EAAE,IAAIA,OAAO,EAAE;MAC7B,IAAIA,OAAO,KAAK,EAAE,EAAE;QAClB2C,WAAW,CAACK,eAAe,CAAC,IAAI,CAAC;MACnC;MACAL,WAAW,CAACM,QAAQ,CAACjD,OAAO,CAAC;IAC/B;IACA4C,aAAa,CAAC;MAAE/B,MAAM;MAAEC;IAAM,CAAC,CAAC;IAChC+B,QAAQ,CAAC;MAAEhC,MAAM;MAAEC;IAAM,CAAC,CAAC;EAC7B,CAAC;EAED,MAAMoC,SAAS,GAAIrC,MAAM,IAAK;IAC5B,IAAIA,MAAM,CAACsC,KAAK,CAAC,cAAc,CAAC,EAAE;MAChC,MAAMC,aAAa,GAAGvC,MAAM,CAACsC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;MACrDN,QAAQ,CAAAjE,aAAA,CAAAA,aAAA,KAAM6B,KAAK;QAAEI,MAAM,EAAEuC;MAAa,EAAE,CAAC;IAC/C,CAAC,MAAM,IAAIvC,MAAM,CAACsC,KAAK,CAAC,OAAO,CAAC,EAAE;MAChCN,QAAQ,CAAAjE,aAAA,CAAAA,aAAA,KAAM6B,KAAK;QAAEI,MAAM,EAAEwC,QAAQ,CAACxC,MAAM,EAAE,EAAE;MAAC,EAAE,CAAC;IACtD;EACF,CAAC;EAED,MAAMyC,QAAQ,GAAIxC,KAAK,IAAK;IAC1B,IAAIA,KAAK,CAACqC,KAAK,CAAC,cAAc,CAAC,EAAE;MAC/B,MAAMI,YAAY,GAAGzC,KAAK,CAACqC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;MACnDN,QAAQ,CAAAjE,aAAA,CAAAA,aAAA,KAAM6B,KAAK;QAAEK,KAAK,EAAEyC;MAAY,EAAE,CAAC;IAC7C,CAAC,MAAM,IAAIzC,KAAK,CAACqC,KAAK,CAAC,OAAO,CAAC,EAAE;MAC/BN,QAAQ,CAAAjE,aAAA,CAAAA,aAAA,KAAM6B,KAAK;QAAEK,KAAK,EAAEuC,QAAQ,CAACvC,KAAK,EAAE,EAAE;MAAC,EAAE,CAAC;IACpD;EACF,CAAC;EAED,MAAM;IACJsB,cAAc;IACd5B,QAAQ;IACRgC,IAAI;IACJ9B,eAAe;IACf+B;EACF,CAAC,GAAGT,OAAM,CAACC,kBAAkB,CAAC;IAAE7B;EAAW,CAAC,CAAC;EAE7C,OAAO;IACLoD,SAAS,EAAGC,SAAS,IAAKC,KAAA,IAAqB;MAAA,IAApB;QAAEC,MAAM,EAAEC;MAAI,CAAC,GAAAF,KAAA;MACxC,MAAMG,SAAS,GAAG;QAAEhD,MAAM,EAAE+C,GAAG,CAACE,aAAa;QAAEhD,KAAK,EAAE8C,GAAG,CAACG;MAAa,CAAC;MACxEjB,MAAM,CAACW,SAAS,CAAC5C,MAAM,GAAG4C,SAAS,GAAGI,SAAS,CAAC;MAChDzB,cAAc,CAACqB,SAAS,CAAC5C,MAAM,GAAG4C,SAAS,GAAGI,SAAS,CAAC;IAC1D,CAAC;IACDrD,QAAQ;IACRgC,IAAI;IACJC,MAAM;IACNrD,KAAK,EAAEqB,KAAK;IACZyC,SAAS;IACTI,QAAQ;IACRU,gBAAgB,EAAEA,CAAA,KAAMlB,MAAM,CAACd,OAAM,CAACR,kBAAkB,CAAC;MACvDpB,UAAU;MACVK,KAAK;MACLD,QAAQ;MACRE;IACF,CAAC,CAAC;EACJ,CAAC;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBAX,OAAA,CAAA2C,cAAA,GAAAA,cAAA;AAkBO,MAAMuB,YAAY,GAAIC,SAAS,IAAK;EACzC,MAAM,CAAC9E,KAAK,EAAE6D,QAAQ,CAAC,GAAGjB,OAAM,CAAClC,KAAK,CAACE,OAAO,CAACkE,SAAS,IAAI,EAAE,CAAC;EAC/D,MAAM,CAAC3D,YAAY,EAAEyC,eAAe,CAAC,GAAGhB,OAAM,CAAClC,KAAK,CAACS,YAAY,CAAC,KAAK,CAAC;EACxE,MAAM,CAACF,2BAA2B,EAAE8D,8BAA8B,CAAC,GAAGnC,OAAM,CAAClC,KAAK,CAACO,2BAA2B,CAAC,KAAK,CAAC;EACrH,MAAM,CAACC,0BAA0B,EAAE8D,6BAA6B,CAAC,GAAGpC,OAAM,CAAClC,KAAK,CAACQ,0BAA0B,CAAC,KAAK,CAAC;EAElH,MAAM+D,eAAe,GAAGA,CAACC,MAAM,EAAEC,aAAa,KAAK;IACjD,IAAIjE,0BAA0B,EAAE;MAC9B,IAAIgE,MAAM,IAAIC,aAAa,EAAE;QAC3BH,6BAA6B,CAAC,KAAK,CAAC;MACtC;IACF;EACF,CAAC;EAED,OAAO;IACLhF,KAAK;IACL6D,QAAQ,EAAGhD,GAAG,IAAK;MACjBgD,QAAQ,CAAChD,GAAG,CAAC;MACboE,eAAe,CAACpE,GAAG,EAAE,IAAI,CAAC;IAC5B,CAAC;IACDM,YAAY;IACZyC,eAAe,EAAGwB,UAAU,IAAK;MAC/BxB,eAAe,CAACwB,UAAU,CAAC;MAC3BH,eAAe,CAAC,IAAI,EAAEG,UAAU,CAAC;IACnC,CAAC;IACDC,KAAK,EAAE;MACLC,IAAI,EAAErE,2BAA2B;MACjCnC,GAAG,EAAEA,CAAA,KAAMiG,8BAA8B,CAAC,IAAI,CAAC;MAC/CQ,OAAO,EAAEA,CAAA,KAAMR,8BAA8B,CAAC,KAAK;IACrD,CAAC;IACDS,UAAU,EAAE;MACVF,IAAI,EAAEpE,0BAA0B;MAChCpC,GAAG,EAAEA,CAAA,KAAMkG,6BAA6B,CAAC,IAAI,CAAC;MAC9CO,OAAO,EAAEA,CAAA,KAAMP,6BAA6B,CAAC,KAAK;IACpD;EACF,CAAC;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AALArE,OAAA,CAAAkE,YAAA,GAAAA,YAAA;AAMO,MAAMY,aAAa,GAAIC,WAAW,IAAM/H,CAAC,IAAK+H,WAAW,CAAC/H,CAAC,CAAC4G,MAAM,CAACvE,KAAK,CAAC;;AAEhF;AACA;AACA;AACA;AACA;AACA;AALAW,OAAA,CAAA8E,aAAA,GAAAA,aAAA;AAMO,MAAME,gBAAgB,GAAID,WAAW,IAAM/H,CAAC,IAAK+H,WAAW,CAAC/H,CAAC,CAAC4G,MAAM,CAACqB,OAAO,CAAC;;AAErF;AACA;AACA;AACA;AACA;AACA;AACA;AANAjF,OAAA,CAAAgF,gBAAA,GAAAA,gBAAA;AAOO,MAAME,mBAAmB,GAAGC,KAAA,IAI7B;EAAA,IAJ8B;IAClClF,OAAO;IACPO,YAAY;IACZ4E;EACF,CAAC,GAAAD,KAAA;EACC,IAAI,CAAC3E,YAAY,IAAIP,OAAO,KAAK,EAAE,EAAE;IACnCmF,aAAa,CAAC,CAAC;IACf,OAAO,KAAK;EACd;EACA,OAAO,IAAI;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPApF,OAAA,CAAAkF,mBAAA,GAAAA,mBAAA;AAQO,MAAMG,WAAW,GAAGC,KAAA;EAAA,IAAC;IAC1BrF,OAAO;IACPI,UAAU;IACVG,YAAY;IACZ+E;EACF,CAAC,GAAAD,KAAA;EAAA,OAAK,MAAM;IACV,IAAIrD,OAAM,CAACiD,mBAAmB,CAAC;MAC7BjF,OAAO,EAAEA,OAAO,CAACZ,KAAK;MACtBmB,YAAY;MACZ4E,aAAa,EAAEA,CAAA,KAAM;QACnBnF,OAAO,CAACyE,KAAK,CAACvG,GAAG,CAAC,CAAC;QACnB8B,OAAO,CAAC4E,UAAU,CAAC1G,GAAG,CAAC,CAAC;MAC1B;IACF,CAAC,CAAC,EAAE;MACF8B,OAAO,CAACyE,KAAK,CAACE,OAAO,CAAC,CAAC;MACvB3E,OAAO,CAAC4E,UAAU,CAACD,OAAO,CAAC,CAAC;MAC5BW,YAAY,CAAC;QACXtF,OAAO,EAAEA,OAAO,CAACZ,KAAK;QACtBgB,UAAU;QACVG;MACF,CAAC,CAAC;IACJ;EACF,CAAC;AAAA;AAACR,OAAA,CAAAqF,WAAA,GAAAA,WAAA;AAAA,IAAAG,QAAA,GAAAxF,OAAA,CAAA3C,OAAA,GAEa;EACb4C,OAAO,EAAEiE,YAAY;EACrB7D,UAAU,EAAEsC,cAAc;EAC1BqC,gBAAgB;EAChBF,aAAa;EACbO,WAAW;EACXH;AACF,CAAC"}