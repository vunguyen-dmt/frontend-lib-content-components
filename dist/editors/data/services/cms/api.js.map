{"version":3,"file":"api.js","names":["_utils","require","urls","_interopRequireWildcard","_utils2","_module","mockApi","_hooks","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","obj","key","value","_toPropertyKey","configurable","writable","_toPrimitive","String","Symbol","toPrimitive","TypeError","Number","fetchByUnitIdOptions","process","env","NODE_ENV","MFE_NAME","headers","Accept","apiMethods","exports","fetchBlockById","_ref","blockId","studioEndpointUrl","block","fetchByUnitId","_ref2","blockAncestor","fetchStudioView","_ref3","blockStudioView","fetchAssets","_ref4","learningContextId","courseAssets","fetchVideos","_ref5","courseVideos","fetchCourseDetails","_ref6","courseDetailsUrl","fetchAdvancedSettings","_ref7","courseAdvanceSettings","uploadAsset","_ref8","asset","data","FormData","append","post","uploadThumbnail","_ref9","videoId","thumbnail","thumbnailUpload","checkTranscriptsForImport","_ref10","youTubeId","getJSON","parameters","encodeURIComponent","importTranscript","_ref11","replaceTranscript","getTranscript","_ref12","language","lang","edx_video_id","videoTranscripts","deleteTranscript","_ref13","deleteJSON","deleteObject","uploadTranscript","_ref14","transcript","newLanguage","normalizeContent","_ref15","blockType","content","title","response","category","courseKey","has_changes","id","metadata","display_name","olx","settings","html5Sources","edxVideoId","youtubeId","module","processVideoIds","videoUrl","videoSource","fallbackVideos","download_video","allowVideoDownloads","public_access","allowVideoSharing","html5_sources","youtube_id_1_0","download_track","allowTranscriptDownloads","track","show_captions","showTranscriptByDefault","handout","start_time","durationStringFromValue","duration","startTime","end_time","stopTime","license","processLicense","licenseType","licenseDetails","saveBlock","_ref16","fetchVideoFeatures","_ref17","videoFeatures","uploadVideo","_ref18","loadImage","imageData","dateAdded","Date","replace","getTime","loadImages","rawImages","camelizeKeys","reduce","image","_ref19","parseYoutubeId","src","isEdxVideo","uuid4Regex","match","youtubeRegex","concat","attribution","noncommercial","noDerivatives","shareAlike","checkMockApi","REACT_APP_DEVGALLERY","emptyMock","_default"],"sources":["../../../../../src/editors/data/services/cms/api.js"],"sourcesContent":["import { camelizeKeys } from '../../../utils';\nimport * as urls from './urls';\nimport { get, post, deleteObject } from './utils';\nimport * as module from './api';\nimport * as mockApi from './mockApi';\nimport { durationStringFromValue } from '../../../containers/VideoEditor/components/VideoSettingsModal/components/DurationWidget/hooks';\n\nconst fetchByUnitIdOptions = {};\n\n// For some reason, the local webpack-dev-server of library-authoring does not accept the normal Accept header.\n// This is a workaround only for that specific case; the idea is to only do this locally and only for library-authoring.\nif (process.env.NODE_ENV === 'development' && process.env.MFE_NAME === 'frontend-app-library-authoring') {\n  fetchByUnitIdOptions.headers = {\n    Accept: '*/*',\n  };\n}\n\nexport const apiMethods = {\n  fetchBlockById: ({ blockId, studioEndpointUrl }) => get(\n    urls.block({ blockId, studioEndpointUrl }),\n  ),\n  fetchByUnitId: ({ blockId, studioEndpointUrl }) => get(\n    urls.blockAncestor({ studioEndpointUrl, blockId }),\n    fetchByUnitIdOptions,\n  ),\n  fetchStudioView: ({ blockId, studioEndpointUrl }) => get(\n    urls.blockStudioView({ studioEndpointUrl, blockId }),\n  ),\n  fetchAssets: ({ learningContextId, studioEndpointUrl }) => get(\n    urls.courseAssets({ studioEndpointUrl, learningContextId }),\n  ),\n  fetchVideos: ({ studioEndpointUrl, learningContextId }) => get(\n    urls.courseVideos({ studioEndpointUrl, learningContextId }),\n  ),\n  fetchCourseDetails: ({ studioEndpointUrl, learningContextId }) => get(\n    urls.courseDetailsUrl({ studioEndpointUrl, learningContextId }),\n  ),\n  fetchAdvancedSettings: ({ studioEndpointUrl, learningContextId }) => get(\n    urls.courseAdvanceSettings({ studioEndpointUrl, learningContextId }),\n  ),\n  uploadAsset: ({\n    learningContextId,\n    studioEndpointUrl,\n    asset,\n  }) => {\n    const data = new FormData();\n    data.append('file', asset);\n    return post(\n      urls.courseAssets({ studioEndpointUrl, learningContextId }),\n      data,\n    );\n  },\n  uploadThumbnail: ({\n    studioEndpointUrl,\n    learningContextId,\n    videoId,\n    thumbnail,\n  }) => {\n    const data = new FormData();\n    data.append('file', thumbnail);\n    return post(\n      urls.thumbnailUpload({ studioEndpointUrl, learningContextId, videoId }),\n      data,\n    );\n  },\n  checkTranscriptsForImport: ({\n    studioEndpointUrl,\n    blockId,\n    youTubeId,\n    videoId,\n  }) => {\n    const getJSON = `{\"locator\":\"${blockId}\",\"videos\":[{\"mode\":\"youtube\",\"video\":\"${youTubeId}\",\"type\":\"youtube\"},{\"mode\":\"edx_video_id\",\"type\":\"edx_video_id\",\"video\":\"${videoId}\"}]}`;\n    return get(\n      urls.checkTranscriptsForImport({\n        studioEndpointUrl,\n        parameters: encodeURIComponent(getJSON),\n      }),\n    );\n  },\n  importTranscript: ({\n    studioEndpointUrl,\n    blockId,\n    youTubeId,\n  }) => {\n    const getJSON = `{\"locator\":\"${blockId}\",\"videos\":[{\"mode\":\"youtube\",\"video\":\"${youTubeId}\",\"type\":\"youtube\"}]}`;\n    return get(\n      urls.replaceTranscript({\n        studioEndpointUrl,\n        parameters: encodeURIComponent(getJSON),\n      }),\n    );\n  },\n  getTranscript: ({\n    studioEndpointUrl,\n    language,\n    blockId,\n    videoId,\n  }) => {\n    const getJSON = { data: { lang: language, edx_video_id: videoId } };\n    return get(\n      `${urls.videoTranscripts({ studioEndpointUrl, blockId })}?language_code=${language}`,\n      getJSON,\n    );\n  },\n\n  deleteTranscript: ({\n    studioEndpointUrl,\n    language,\n    blockId,\n    videoId,\n  }) => {\n    const deleteJSON = { data: { lang: language, edx_video_id: videoId } };\n    return deleteObject(\n      urls.videoTranscripts({ studioEndpointUrl, blockId }),\n      deleteJSON,\n    );\n  },\n  uploadTranscript: ({\n    blockId,\n    studioEndpointUrl,\n    transcript,\n    videoId,\n    language,\n    newLanguage = null,\n  }) => {\n    const data = new FormData();\n    data.append('file', transcript);\n    data.append('edx_video_id', videoId);\n    data.append('language_code', language);\n    data.append('new_language_code', newLanguage || language);\n    return post(\n      urls.videoTranscripts({ studioEndpointUrl, blockId }),\n      data,\n    );\n  },\n  normalizeContent: ({\n    blockId,\n    blockType,\n    content,\n    learningContextId,\n    title,\n  }) => {\n    let response = {};\n    if (blockType === 'html') {\n      response = {\n        category: blockType,\n        courseKey: learningContextId,\n        data: content,\n        has_changes: true,\n        id: blockId,\n        metadata: { display_name: title },\n      };\n    } else if (blockType === 'problem') {\n      response = {\n        data: content.olx,\n        category: blockType,\n        courseKey: learningContextId,\n        has_changes: true,\n        id: blockId,\n        metadata: { display_name: title, ...content.settings },\n      };\n    } else if (blockType === 'video') {\n      const {\n        html5Sources,\n        edxVideoId,\n        youtubeId,\n      } = module.processVideoIds({\n        videoId: content.videoId,\n        videoUrl: content.videoSource,\n        fallbackVideos: content.fallbackVideos,\n      });\n      response = {\n        category: blockType,\n        courseKey: learningContextId,\n        display_name: title,\n        id: blockId,\n        metadata: {\n          display_name: title,\n          download_video: content.allowVideoDownloads,\n          public_access: content.allowVideoSharing.value,\n          edx_video_id: edxVideoId,\n          html5_sources: html5Sources,\n          youtube_id_1_0: youtubeId,\n          thumbnail: content.thumbnail,\n          download_track: content.allowTranscriptDownloads,\n          track: '', // TODO Downloadable Transcript URL. Backend expects a file name, for example: \"something.srt\"\n          show_captions: content.showTranscriptByDefault,\n          handout: content.handout,\n          start_time: durationStringFromValue(content.duration.startTime),\n          end_time: durationStringFromValue(content.duration.stopTime),\n          license: module.processLicense(content.licenseType, content.licenseDetails),\n        },\n      };\n    } else {\n      throw new TypeError(`No Block in V2 Editors named /\"${blockType}/\", Cannot Save Content.`);\n    }\n    return { ...response };\n  },\n  saveBlock: ({\n    blockId,\n    blockType,\n    content,\n    learningContextId,\n    studioEndpointUrl,\n    title,\n  }) => post(\n    urls.block({ studioEndpointUrl, blockId }),\n    module.apiMethods.normalizeContent({\n      blockType,\n      content,\n      blockId,\n      learningContextId,\n      title,\n    }),\n  ),\n  fetchVideoFeatures: ({\n    studioEndpointUrl,\n  }) => get(\n    urls.videoFeatures({ studioEndpointUrl }),\n  ),\n  uploadVideo: ({\n    data,\n    studioEndpointUrl,\n    learningContextId,\n  }) => post(\n    urls.courseVideos({ studioEndpointUrl, learningContextId }),\n    data,\n  ),\n};\n\nexport const loadImage = (imageData) => ({\n  ...imageData,\n  dateAdded: new Date(imageData.dateAdded.replace(' at', '')).getTime(),\n});\n\nexport const loadImages = (rawImages) => camelizeKeys(rawImages).reduce(\n  (obj, image) => ({ ...obj, [image.id]: module.loadImage(image) }),\n  {},\n);\n\nexport const processVideoIds = ({\n  videoId,\n  videoUrl,\n  fallbackVideos,\n}) => {\n  let youtubeId = '';\n  const html5Sources = [];\n\n  if (videoUrl) {\n    if (module.parseYoutubeId(videoUrl)) {\n      youtubeId = module.parseYoutubeId(videoUrl);\n    } else {\n      html5Sources.push(videoUrl);\n    }\n  }\n\n  if (fallbackVideos) {\n    fallbackVideos.forEach((src) => (src ? html5Sources.push(src) : null));\n  }\n\n  return {\n    edxVideoId: videoId,\n    html5Sources,\n    youtubeId,\n  };\n};\n\nexport const isEdxVideo = (src) => {\n  const uuid4Regex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/;\n  if (src && src.match(uuid4Regex)) {\n    return true;\n  }\n  return false;\n};\n\nexport const parseYoutubeId = (src) => {\n  const youtubeRegex = /^((?:https?:)?\\/\\/)?((?:www|m)\\.)?((?:youtube\\.com|youtu.be))(\\/(?:[\\w-]+\\?v=|embed\\/|v\\/)?)([\\w-]+)(\\S+)?$/;\n  if (!src.match(youtubeRegex)) {\n    return null;\n  }\n  return src.match(youtubeRegex)[5];\n};\n\nexport const processLicense = (licenseType, licenseDetails) => {\n  if (licenseType === 'creative-commons') {\n    return 'creative-commons: ver=4.0'.concat(\n      (licenseDetails.attribution ? ' BY' : ''),\n      (licenseDetails.noncommercial ? ' NC' : ''),\n      (licenseDetails.noDerivatives ? ' ND' : ''),\n      (licenseDetails.shareAlike ? ' SA' : ''),\n    );\n  }\n  if (licenseType === 'all-rights-reserved') {\n    return 'all-rights-reserved';\n  }\n  return '';\n};\n\nexport const checkMockApi = (key) => {\n  if (process.env.REACT_APP_DEVGALLERY) {\n    return mockApi[key] ? mockApi[key] : mockApi.emptyMock;\n  }\n  return module.apiMethods[key];\n};\n\nexport default Object.keys(apiMethods).reduce(\n  (obj, key) => ({ ...obj, [key]: checkMockApi(key) }),\n  {},\n);\n"],"mappings":"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"}