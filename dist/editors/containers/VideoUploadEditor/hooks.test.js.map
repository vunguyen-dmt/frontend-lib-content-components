{"version":3,"file":"hooks.test.js","names":["_hooks","_interopRequireDefault","require","requests","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","jest","mock","describe","dispatch","fn","supportedFiles","File","type","beforeEach","resetAllMocks","restoreAllMocks","it","uploadVideo","mockImplementation","data","files","file_name","content_type","hooks","expect","toHaveBeenCalledWith","onSuccess","any","Function","mockResponseData","success","mockFetchResponse","Promise","resolve","global","fetch","response","upload_url","mockRequestResponse","_ref","toHaveBeenCalledTimes","forEach","_ref2","index","uploadUrl","calls","toEqual","file","body","toBe","error","Error","mockRejectedValue","_ref3","spyConsoleError","spyOn","console","_ref4"],"sources":["../../../../src/editors/containers/VideoUploadEditor/hooks.test.js"],"sourcesContent":["import hooks from './hooks';\nimport * as requests from '../../data/redux/thunkActions/requests';\n\njest.mock('../../data/redux/thunkActions/requests');\n\ndescribe('uploadVideo', () => {\n  const dispatch = jest.fn();\n  const supportedFiles = [\n    new File(['content1'], 'file1.mp4', { type: 'video/mp4' }),\n    new File(['content2'], 'file2.mov', { type: 'video/quicktime' }),\n  ];\n\n  beforeEach(() => {\n    jest.resetAllMocks();\n    jest.restoreAllMocks();\n  });\n\n  it('should dispatch uploadVideo action with correct data and onSuccess callback', async () => {\n    requests.uploadVideo.mockImplementation(() => 'requests.uploadVideo');\n    const data = {\n      files: [\n        { file_name: 'file1.mp4', content_type: 'video/mp4' },\n        { file_name: 'file2.mov', content_type: 'video/quicktime' },\n      ],\n    };\n\n    await hooks.uploadVideo({ dispatch, supportedFiles });\n\n    expect(requests.uploadVideo).toHaveBeenCalledWith({ data, onSuccess: expect.any(Function) });\n    expect(dispatch).toHaveBeenCalledWith('requests.uploadVideo');\n  });\n\n  it('should call fetch with correct arguments for each file', async () => {\n    const mockResponseData = { success: true };\n    const mockFetchResponse = Promise.resolve({ data: mockResponseData });\n    global.fetch = jest.fn().mockImplementation(() => mockFetchResponse);\n    const response = {\n      files: [\n        { file_name: 'file1.mp4', upload_url: 'http://example.com/put_video1' },\n        { file_name: 'file2.mov', upload_url: 'http://example.com/put_video2' },\n      ],\n    };\n    const mockRequestResponse = { data: response };\n    requests.uploadVideo.mockImplementation(async ({ onSuccess }) => {\n      await onSuccess(mockRequestResponse);\n    });\n\n    await hooks.uploadVideo({ dispatch, supportedFiles });\n\n    expect(fetch).toHaveBeenCalledTimes(2);\n    response.files.forEach(({ upload_url: uploadUrl }, index) => {\n      expect(fetch.mock.calls[index][0]).toEqual(uploadUrl);\n    });\n    supportedFiles.forEach((file, index) => {\n      expect(fetch.mock.calls[index][1].body.get('uploaded-file')).toBe(file);\n    });\n  });\n\n  it('should log an error if fetch failed to upload a file', async () => {\n    const error = new Error('Uh-oh!');\n    global.fetch = jest.fn().mockRejectedValue(error);\n    const response = {\n      files: [\n        { file_name: 'file1.mp4', upload_url: 'http://example.com/put_video1' },\n        { file_name: 'file2.mov', upload_url: 'http://example.com/put_video2' },\n      ],\n    };\n    const mockRequestResponse = { data: response };\n    requests.uploadVideo.mockImplementation(async ({ onSuccess }) => {\n      await onSuccess(mockRequestResponse);\n    });\n\n    await hooks.uploadVideo({ dispatch, supportedFiles });\n  });\n\n  it('should log an error if file object is not found in supportedFiles array', () => {\n    const response = {\n      files: [\n        { file_name: 'file2.mov', upload_url: 'http://example.com/put_video2' },\n      ],\n    };\n    const mockRequestResponse = { data: response };\n    const spyConsoleError = jest.spyOn(console, 'error');\n    requests.uploadVideo.mockImplementation(({ onSuccess }) => {\n      onSuccess(mockRequestResponse);\n    });\n\n    hooks.uploadVideo({ dispatch, supportedFiles: [supportedFiles[0]] });\n\n    expect(spyConsoleError).toHaveBeenCalledWith('Could not find file object with name \"file2.mov\" in supportedFiles array.');\n  });\n});\n"],"mappings":"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"}