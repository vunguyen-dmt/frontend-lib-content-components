{"version":3,"file":"hooks.test.js","names":["_react","_interopRequireDefault","require","_reactRedux","_redux","_testUtils","hooks","_interopRequireWildcard","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","jest","mock","updateState","fn","useState","val","state","newVal","createRef","ref","navigateCallback","args","actions","app","setBlockTitle","selectors","displayTitle","MockUseState","describe","output","dispatch","beforeEach","testGetter","keys","localTitle","afterEach","restore","isEditing","test","expect","toEqual","startEditing","React","toHaveBeenCalledWith","stopEditing","useSelector","it","div","document","createElement","mockEvent","currentTarget","updateTitle","toHaveBeenCalled","value","handleChange","target","setState","cancelEdit","oldHooks","values","newHooks","handleKeyDown","localTitleHooks","inputRef","undefined"],"sources":["../../../../../../src/editors/containers/EditorContainer/components/TitleHeader/hooks.test.js"],"sourcesContent":["import React from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { actions, selectors } from '../../../../data/redux';\nimport { MockUseState } from '../../../../../testUtils';\nimport * as hooks from './hooks';\n\njest.mock('react', () => {\n  const updateState = jest.fn();\n  return {\n    updateState,\n    useState: jest.fn(val => ([{ state: val }, (newVal) => updateState({ val, newVal })])),\n    createRef: jest.fn(val => ({ ref: val })),\n  };\n});\n\njest.mock('../../hooks', () => ({\n  navigateCallback: (args) => ({ navigateCallback: args }),\n}));\n\njest.mock('../../../../data/redux', () => ({\n  actions: {\n    app: {\n      setBlockTitle: (args) => ({ setBlockTitle: args }),\n    },\n  },\n  selectors: {\n    app: {\n      displayTitle: (state) => ({ displayTitle: state }),\n    },\n  },\n}));\n\nconst state = new MockUseState(hooks);\n\ndescribe('TitleHeader hooks', () => {\n  let output;\n  let dispatch;\n  beforeEach(() => {\n    dispatch = jest.fn();\n  });\n  describe('state hooks', () => {\n    state.testGetter(state.keys.localTitle);\n  });\n  describe('non-state hooks', () => {\n    beforeEach(() => { state.mock(); });\n    afterEach(() => { state.restore(); });\n\n    describe('isEditing', () => {\n      beforeEach(() => {\n        output = hooks.hooks.isEditing();\n      });\n      test('returns isEditing field, defaulted to false', () => {\n        expect(output.isEditing).toEqual({ state: false });\n      });\n      test('startEditing calls the setter function with true', () => {\n        output.startEditing();\n        expect(React.updateState).toHaveBeenCalledWith({ val: false, newVal: true });\n      });\n      test('stopEditing calls the setter function with false', () => {\n        output.stopEditing();\n        expect(React.updateState).toHaveBeenCalledWith({ val: false, newVal: false });\n      });\n    });\n\n    describe('localTitle', () => {\n      let stopEditing;\n      beforeEach(() => {\n        stopEditing = jest.fn();\n        output = hooks.hooks.localTitle({ dispatch, stopEditing });\n      });\n      test('returns the state value for localTitle, defaulted to displayTitle', () => {\n        expect(output.localTitle).toEqual(useSelector(selectors.app.displayTitle));\n      });\n      describe('updateTitle hook', () => {\n        it('calls setBlockTitle with localTitle, and stopEditing', () => {\n          const div = document.createElement('div');\n          const mockEvent = { currentTarget: div };\n          output.updateTitle(mockEvent);\n          expect(dispatch).toHaveBeenCalledWith(actions.app.setBlockTitle(output.localTitle));\n          expect(stopEditing).toHaveBeenCalled();\n        });\n      });\n      describe('handleChange', () => {\n        it('calls setLocalTitle with the event target value', () => {\n          const value = 'SOME VALUe';\n          output.handleChange({ target: { value } });\n          expect(state.setState[state.keys.localTitle]).toHaveBeenCalledWith(value);\n        });\n      });\n      describe('cancelEdit', () => {\n        it('calls setLocalTitle with previously stored title, and stopEditing', () => {\n          output.cancelEdit();\n          expect(state.setState[state.keys.localTitle]).toHaveBeenCalledWith(useSelector(selectors.app.displayTitle));\n          expect(stopEditing).toHaveBeenCalled();\n        });\n      });\n    });\n    describe('local title hooks', () => {\n      let oldHooks;\n      const values = {\n        isEditing: 'ISeDITING',\n        startEditing: 'STARTeDITING',\n        stopEditing: 'STOPeDITING',\n        handleChange: 'HANDLEcHANGE',\n        localTitle: 'LOCALtITLE',\n        cancelEdit: 'CANCelEDit',\n      };\n      const newHooks = {\n        isEditing: () => ({\n          isEditing: values.isEditing,\n          startEditing: values.startEditing,\n          stopEditing: values.stopEditing,\n        }),\n        localTitle: jest.fn((args) => ({\n          updateTitle: args,\n          handleChange: values.handleChange,\n          localTitle: values.localTitle,\n          cancelEdit: values.cancelEdit,\n        })),\n        handleKeyDown: jest.fn(args => ({ handleKeyDown: args })),\n      };\n      beforeEach(() => {\n        oldHooks = hooks.hooks;\n        hooks.hooks.isEditing = newHooks.isEditing;\n        hooks.hooks.localTitle = newHooks.localTitle;\n        hooks.hooks.handleKeyDown = newHooks.handleKeyDown;\n\n        output = hooks.localTitleHooks({ dispatch });\n      });\n      afterEach(() => {\n        // eslint-disable-next-line no-import-assign\n        hooks.hooks = oldHooks;\n      });\n      it('returns isEditing, startEditing, and stopEditing, tied to the isEditing hook', () => {\n        expect(output.isEditing).toEqual(values.isEditing);\n        expect(output.startEditing).toEqual(values.startEditing);\n        expect(output.stopEditing).toEqual(values.stopEditing);\n      });\n      it('returns localTitle, updateTitle, handleChange, and cancelEdit tied to the localTitle hook', () => {\n        expect(output.updateTitle).toEqual({\n          dispatch,\n          stopEditing: values.stopEditing,\n        });\n        expect(output.handleChange).toEqual(values.handleChange);\n        expect(output.localTitle).toEqual(values.localTitle);\n        expect(output.cancelEdit).toEqual(values.cancelEdit);\n      });\n      it('returns a new ref for inputRef', () => {\n        expect(output.inputRef).toEqual({ ref: undefined });\n      });\n    });\n  });\n});\n"],"mappings":"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"}