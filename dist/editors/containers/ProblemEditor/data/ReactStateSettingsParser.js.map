{"version":3,"file":"ReactStateSettingsParser.js","names":["_fastXmlParser","require","_SettingsParser","SETTING_KEYS","ReactStateSettingsParser","constructor","problemState","problem","rawOLX","getSettings","settings","stateSettings","popuplateItem","scoring","attempts","showAnswer","parseRawOlxSettings","rawOlxSettings","parserOptions","ignoreAttributes","alwaysCreateTextNode","numberParseOptions","leadingZeros","hex","parser","XMLParser","olx","parse","settingAttributes","Object","keys","filter","tag","startsWith","forEach","attribute","attributeKey","substring","includes","parseInt","_default","exports","default"],"sources":["../../../../../src/editors/containers/ProblemEditor/data/ReactStateSettingsParser.js"],"sourcesContent":["import { XMLParser } from 'fast-xml-parser';\nimport { popuplateItem } from './SettingsParser';\n\nconst SETTING_KEYS = [\n  'max_attempts',\n  'weight',\n  'showanswer',\n  'show_reset_button',\n  'rerandomize',\n];\n\nclass ReactStateSettingsParser {\n  constructor(problemState) {\n    this.problem = problemState.problem;\n    this.rawOLX = problemState.rawOLX;\n  }\n\n  getSettings() {\n    let settings = {};\n    const stateSettings = this.problem.settings;\n\n    settings = popuplateItem(settings, 'number', 'max_attempts', stateSettings.scoring.attempts, true);\n    settings = popuplateItem(settings, 'weight', 'weight', stateSettings.scoring);\n    settings = popuplateItem(settings, 'on', 'showanswer', stateSettings.showAnswer);\n    settings = popuplateItem(settings, 'afterAttempts', 'attempts_before_showanswer_button', stateSettings.showAnswer);\n    settings = popuplateItem(settings, 'showResetButton', 'show_reset_button', stateSettings);\n    settings = popuplateItem(settings, 'timeBetween', 'submission_wait_seconds', stateSettings);\n    settings = popuplateItem(settings, 'randomization', 'rerandomize', stateSettings);\n\n    return settings;\n  }\n\n  parseRawOlxSettings() {\n    const rawOlxSettings = this.getSettings();\n    // console.log(rawOlxSettings);\n    // console.log(this.rawOLX);\n    const parserOptions = {\n      ignoreAttributes: false,\n      alwaysCreateTextNode: true,\n      numberParseOptions: {\n        leadingZeros: false,\n        hex: false,\n      },\n    };\n    const parser = new XMLParser(parserOptions);\n    const olx = parser.parse(this.rawOLX);\n    const settingAttributes = Object.keys(olx.problem).filter(tag => tag.startsWith('@_'));\n    settingAttributes.forEach(attribute => {\n      const attributeKey = attribute.substring(2);\n      if (SETTING_KEYS.includes(attributeKey)) {\n        if (attributeKey === 'max_attempts' || attributeKey === 'weight') {\n          rawOlxSettings[attributeKey] = parseInt(olx.problem[attribute]);\n        } else {\n          rawOlxSettings[attributeKey] = olx.problem[attribute];\n        }\n      }\n    });\n    return rawOlxSettings;\n  }\n}\n\nexport default ReactStateSettingsParser;\n"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAD,OAAA;AAEA,MAAME,YAAY,GAAG,CACnB,cAAc,EACd,QAAQ,EACR,YAAY,EACZ,mBAAmB,EACnB,aAAa,CACd;AAED,MAAMC,wBAAwB,CAAC;EAC7BC,WAAWA,CAACC,YAAY,EAAE;IACxB,IAAI,CAACC,OAAO,GAAGD,YAAY,CAACC,OAAO;IACnC,IAAI,CAACC,MAAM,GAAGF,YAAY,CAACE,MAAM;EACnC;EAEAC,WAAWA,CAAA,EAAG;IACZ,IAAIC,QAAQ,GAAG,CAAC,CAAC;IACjB,MAAMC,aAAa,GAAG,IAAI,CAACJ,OAAO,CAACG,QAAQ;IAE3CA,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,QAAQ,EAAE,cAAc,EAAEC,aAAa,CAACE,OAAO,CAACC,QAAQ,EAAE,IAAI,CAAC;IAClGJ,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAEC,aAAa,CAACE,OAAO,CAAC;IAC7EH,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,IAAI,EAAE,YAAY,EAAEC,aAAa,CAACI,UAAU,CAAC;IAChFL,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,eAAe,EAAE,mCAAmC,EAAEC,aAAa,CAACI,UAAU,CAAC;IAClHL,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,iBAAiB,EAAE,mBAAmB,EAAEC,aAAa,CAAC;IACzFD,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,aAAa,EAAE,yBAAyB,EAAEC,aAAa,CAAC;IAC3FD,QAAQ,GAAG,IAAAE,6BAAa,EAACF,QAAQ,EAAE,eAAe,EAAE,aAAa,EAAEC,aAAa,CAAC;IAEjF,OAAOD,QAAQ;EACjB;EAEAM,mBAAmBA,CAAA,EAAG;IACpB,MAAMC,cAAc,GAAG,IAAI,CAACR,WAAW,CAAC,CAAC;IACzC;IACA;IACA,MAAMS,aAAa,GAAG;MACpBC,gBAAgB,EAAE,KAAK;MACvBC,oBAAoB,EAAE,IAAI;MAC1BC,kBAAkB,EAAE;QAClBC,YAAY,EAAE,KAAK;QACnBC,GAAG,EAAE;MACP;IACF,CAAC;IACD,MAAMC,MAAM,GAAG,IAAIC,wBAAS,CAACP,aAAa,CAAC;IAC3C,MAAMQ,GAAG,GAAGF,MAAM,CAACG,KAAK,CAAC,IAAI,CAACnB,MAAM,CAAC;IACrC,MAAMoB,iBAAiB,GAAGC,MAAM,CAACC,IAAI,CAACJ,GAAG,CAACnB,OAAO,CAAC,CAACwB,MAAM,CAACC,GAAG,IAAIA,GAAG,CAACC,UAAU,CAAC,IAAI,CAAC,CAAC;IACtFL,iBAAiB,CAACM,OAAO,CAACC,SAAS,IAAI;MACrC,MAAMC,YAAY,GAAGD,SAAS,CAACE,SAAS,CAAC,CAAC,CAAC;MAC3C,IAAIlC,YAAY,CAACmC,QAAQ,CAACF,YAAY,CAAC,EAAE;QACvC,IAAIA,YAAY,KAAK,cAAc,IAAIA,YAAY,KAAK,QAAQ,EAAE;UAChEnB,cAAc,CAACmB,YAAY,CAAC,GAAGG,QAAQ,CAACb,GAAG,CAACnB,OAAO,CAAC4B,SAAS,CAAC,CAAC;QACjE,CAAC,MAAM;UACLlB,cAAc,CAACmB,YAAY,CAAC,GAAGV,GAAG,CAACnB,OAAO,CAAC4B,SAAS,CAAC;QACvD;MACF;IACF,CAAC,CAAC;IACF,OAAOlB,cAAc;EACvB;AACF;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEctC,wBAAwB"}