{"version":3,"file":"hooks.js","names":["_react","_interopRequireDefault","require","_reactRedux","_redux","_module","_interopRequireWildcard","_utils","_messages","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","value","_toPropertyKey","configurable","writable","_toPrimitive","String","Symbol","toPrimitive","TypeError","Number","state","exports","highlighted","val","React","useState","showSelectImageError","searchString","sortBy","showSizeError","searchAndSortHooks","setSearchString","module","setSortBy","sortKeys","dateNewest","onSearchChange","target","clearSearchString","onSortClick","sortMessages","filteredList","_ref","imageList","_ref2","displayName","toLowerCase","includes","displayList","_ref3","images","sort","sortFunctions","imgListHooks","_ref4","searchSortProps","setSelection","setHighlighted","setShowSelectImageError","setShowSizeError","list","galleryError","show","dismiss","message","messages","selectImageError","inputError","fileSizeError","galleryProps","galleryIsEmpty","searchIsEmpty","onHighlightChange","emptyGalleryLabel","selectBtnProps","onClick","highlightedImage","find","image","id","checkValidFileSize","_ref5","selectedFile","clearSelection","onSizeFail","size","fileInputHooks","_ref6","imgList","dispatch","useDispatch","ref","useRef","click","current","addFile","files","thunkActions","app","uploadImage","file","imgHooks","_ref7","fileInput","_default"],"sources":["../../../../../src/editors/sharedComponents/ImageUploadModal/SelectImageModal/hooks.js"],"sourcesContent":["import React from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { thunkActions } from '../../../data/redux';\nimport * as module from './hooks';\nimport { sortFunctions, sortKeys, sortMessages } from './utils';\nimport messages from './messages';\n\nexport const state = {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  highlighted: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  showSelectImageError: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  searchString: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  sortBy: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  showSizeError: (val) => React.useState(val),\n};\n\nexport const searchAndSortHooks = () => {\n  const [searchString, setSearchString] = module.state.searchString('');\n  const [sortBy, setSortBy] = module.state.sortBy(sortKeys.dateNewest);\n  return {\n    searchString,\n    onSearchChange: (e) => setSearchString(e.target.value),\n    clearSearchString: () => setSearchString(''),\n    sortBy,\n    onSortClick: (key) => () => setSortBy(key),\n    sortKeys,\n    sortMessages,\n  };\n};\n\nexport const filteredList = ({ searchString, imageList }) => (\n  imageList.filter(({ displayName }) => displayName?.toLowerCase().includes(searchString?.toLowerCase()))\n);\n\nexport const displayList = ({ sortBy, searchString, images }) => (\n  module.filteredList({\n    searchString,\n    imageList: images,\n  }).sort(sortFunctions[sortBy in sortKeys ? sortKeys[sortBy] : sortKeys.dateNewest]));\n\nexport const imgListHooks = ({ searchSortProps, setSelection, images }) => {\n  const [highlighted, setHighlighted] = module.state.highlighted(null);\n  const [\n    showSelectImageError,\n    setShowSelectImageError,\n  ] = module.state.showSelectImageError(false);\n  const [showSizeError, setShowSizeError] = module.state.showSizeError(false);\n  const list = module.displayList({ ...searchSortProps, images });\n\n  return {\n    galleryError: {\n      show: showSelectImageError,\n      set: () => setShowSelectImageError(true),\n      dismiss: () => setShowSelectImageError(false),\n      message: messages.selectImageError,\n    },\n    inputError: {\n      show: showSizeError,\n      set: () => setShowSizeError(true),\n      dismiss: () => setShowSizeError(false),\n      message: messages.fileSizeError,\n    },\n    images,\n    galleryProps: {\n      galleryIsEmpty: Object.keys(images).length === 0,\n      searchIsEmpty: list.length === 0,\n      displayList: list,\n      highlighted,\n      onHighlightChange: (e) => setHighlighted(e.target.value),\n      emptyGalleryLabel: messages.emptyGalleryLabel,\n    },\n    // highlight by id\n    selectBtnProps: {\n      onClick: () => {\n        if (highlighted) {\n          const highlightedImage = images.find(image => image.id === highlighted);\n          setSelection(highlightedImage);\n        } else {\n          setShowSelectImageError(true);\n        }\n      },\n    },\n  };\n};\n\nexport const checkValidFileSize = ({\n  selectedFile,\n  clearSelection,\n  onSizeFail,\n}) => {\n  // Check if the file size is greater than 10 MB, upload size limit\n  if (selectedFile.size > 10000000) {\n    clearSelection();\n    onSizeFail();\n    return false;\n  }\n  return true;\n};\n\nexport const fileInputHooks = ({ setSelection, clearSelection, imgList }) => {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const dispatch = useDispatch();\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const ref = React.useRef();\n  const click = () => ref.current.click();\n  const addFile = (e) => {\n    const selectedFile = e.target.files[0];\n    if (selectedFile && module.checkValidFileSize({\n      selectedFile,\n      clearSelection,\n      onSizeFail: () => {\n        imgList.inputError.set();\n      },\n    })) {\n      dispatch(\n        thunkActions.app.uploadImage({\n          file: selectedFile,\n          setSelection,\n        }),\n      );\n    }\n  };\n\n  return {\n    click,\n    addFile,\n    ref,\n  };\n};\n\nexport const imgHooks = ({ setSelection, clearSelection, images }) => {\n  const searchSortProps = module.searchAndSortHooks();\n  const imgList = module.imgListHooks({ setSelection, searchSortProps, images });\n  const fileInput = module.fileInputHooks({\n    setSelection,\n    clearSelection,\n    imgList,\n  });\n  const {\n    galleryError,\n    galleryProps,\n    inputError,\n    selectBtnProps,\n  } = imgList;\n\n  return {\n    galleryError,\n    inputError,\n    fileInput,\n    galleryProps,\n    searchSortProps,\n    selectBtnProps,\n  };\n};\n\nexport default {\n  imgHooks,\n};\n"],"mappings":"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"}