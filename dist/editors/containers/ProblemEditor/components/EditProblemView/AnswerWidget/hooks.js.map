{"version":3,"file":"hooks.js","names":["_react","require","_utils","_module","_interopRequireWildcard","_redux","_problem","_hooks2","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","state","exports","StrictDict","isFeedbackVisible","val","useState","removeAnswer","_ref","answer","dispatch","actions","problem","deleteAnswer","id","correct","editorState","fetchEditorContent","format","setAnswer","_ref2","hasSingleAnswer","payload","updateAnswer","setAnswerTitle","_ref3","problemType","updatedTitle","title","ProblemTypeKeys","TEXTINPUT","NUMERIC","DROPDOWN","includes","setSelectedFeedback","_ref4","e","selectedFeedback","setUnselectedFeedback","_ref5","unselectedFeedback","useFeedback","setIsFeedbackVisible","module","useEffect","isVisible","toggleFeedback","open","isSingleAnswerProblem","useAnswerContainer","_ref6","answers","updateField","answerCount","correctAnswerCount","_default"],"sources":["../../../../../../../src/editors/containers/ProblemEditor/components/EditProblemView/AnswerWidget/hooks.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { StrictDict } from '../../../../../utils';\nimport * as module from './hooks';\nimport { actions } from '../../../../../data/redux';\nimport { ProblemTypeKeys } from '../../../../../data/constants/problem';\nimport { fetchEditorContent } from '../hooks';\n\nexport const state = StrictDict({\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  isFeedbackVisible: (val) => useState(val),\n});\n\nexport const removeAnswer = ({\n  answer,\n  dispatch,\n}) => () => {\n  dispatch(actions.problem.deleteAnswer({\n    id: answer.id,\n    correct: answer.correct,\n    editorState: fetchEditorContent({ format: '' }),\n  }));\n};\n\nexport const setAnswer = ({ answer, hasSingleAnswer, dispatch }) => (payload) => {\n  dispatch(actions.problem.updateAnswer({ id: answer.id, hasSingleAnswer, ...payload }));\n};\n\nexport const setAnswerTitle = ({\n  answer,\n  hasSingleAnswer,\n  dispatch,\n  problemType,\n}) => (updatedTitle) => {\n  let title = updatedTitle;\n  if ([ProblemTypeKeys.TEXTINPUT, ProblemTypeKeys.NUMERIC, ProblemTypeKeys.DROPDOWN].includes(problemType)) {\n    title = updatedTitle.target.value;\n  }\n  dispatch(actions.problem.updateAnswer({ id: answer.id, hasSingleAnswer, title }));\n};\n\nexport const setSelectedFeedback = ({ answer, hasSingleAnswer, dispatch }) => (e) => {\n  dispatch(actions.problem.updateAnswer({\n    id: answer.id,\n    hasSingleAnswer,\n    selectedFeedback: e.target.value,\n  }));\n};\n\nexport const setUnselectedFeedback = ({ answer, hasSingleAnswer, dispatch }) => (e) => {\n  dispatch(actions.problem.updateAnswer({\n    id: answer.id,\n    hasSingleAnswer,\n    unselectedFeedback: e.target.value,\n  }));\n};\n\nexport const useFeedback = (answer) => {\n  const [isFeedbackVisible, setIsFeedbackVisible] = module.state.isFeedbackVisible(false);\n  useEffect(() => {\n    // Show feedback fields if feedback is present\n    const isVisible = !!answer.selectedFeedback || !!answer.unselectedFeedback;\n    setIsFeedbackVisible(isVisible);\n  }, [answer]);\n\n  const toggleFeedback = (open) => {\n    // Do not allow to hide if feedback is added\n    const { selectedFeedback, unselectedFeedback } = fetchEditorContent({ format: '' });\n\n    if (!!selectedFeedback?.[answer.id] || !!unselectedFeedback?.[answer.id]) {\n      setIsFeedbackVisible(true);\n      return;\n    }\n    setIsFeedbackVisible(open);\n  };\n  return {\n    isFeedbackVisible,\n    toggleFeedback,\n  };\n};\n\nexport const isSingleAnswerProblem = (problemType) => (\n  problemType === ProblemTypeKeys.DROPDOWN\n);\n\nexport const useAnswerContainer = ({ answers, updateField }) => {\n  useEffect(() => {\n    let answerCount = 0;\n    answers.forEach(answer => {\n      if (answer.correct) {\n        answerCount += 1;\n      }\n    });\n    updateField({ correctAnswerCount: answerCount });\n  }, []);\n};\n\nexport default {\n  state, removeAnswer, setAnswer, setAnswerTitle, useFeedback, isSingleAnswerProblem, useAnswerContainer,\n};\n"],"mappings":"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"}